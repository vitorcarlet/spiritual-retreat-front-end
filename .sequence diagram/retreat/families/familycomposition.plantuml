@startuml name "Composição Manual de Famílias"
actor Gestor
participant "Tela de Composição" as Composicao
participant "Validador em Tempo Real" as Validador
participant "Backend de Famílias" as Backend
participant "Feedback Visual" as Feedback

Gestor -> Composicao : Arrasta membro para uma família

Composicao -> Validador : Verifica:
note right of Validador
 - Limite de membros
 - Conflito de cônjuges/parentes
 - Proporção de gênero
 - Padrinhos/madrinhas
end note
alt Alguma regra violada
    Validador -> Feedback : Exibe alerta visual
else Válido
    Composicao -> Backend : Atualiza composição da família
    Backend -> Backend : Persiste nova alocação
    Backend --> Composicao : Retorna sucesso
    Composicao -> Feedback : Atualiza estatísticas (percentual H/M, padrinhos, etc.)
end
@enduml
